/*
ALTER DATABASE CURRENT SET QUERY_STORE CLEAR
*/

-- 10 件の統計情報の状態でクエリを実行
UPDATE STATISTICS T_Emp(IX_Flag) WITH STATS_STREAM = 0x010000000200000000000000000000002B1CE23900000000E00100000000000088010000000000003003000030000000010003000000000000000000DE0100003803FFFF3800000004000A000000000000000000020000000700000083CFCD0061A700000A000000000000000A00000000000000000000000000803FCDCCCC3D00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000100000002000000110000000000A04000002041000000000000803F0000804000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000001C00000000000000240000000000000008000000000000001000110000002041000000000000803F000400000A00000000000000
GO
DBCC FREEPROCCACHE
GO

DECLARE @key int = 0
EXEC sp_executesql N'SELECT * FROM T_Emp WHERE Flag = @p1', N'@p1 int', @key
WAITFOR DELAY '00:00:01'
GO 10

-- 100 万件の統計情報の状態でクエリを実行
UPDATE STATISTICS T_Emp(IX_Flag) WITH STATS_STREAM = 0x01000000020000000000000000000000FE816841000000005402000000000000FC010000000000003003C4C630000000010003000000000000000000DE0100003803C4C63800000004000A0000000000000000000000000007000000FFFBCD0061A7000040420F000000000040420F0000000000000000000000003FBD37863500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000200000002000000110000000000A04000247449000000000000803F000080400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000019000000000000000000000000000000380000000000000088000000000000009000000000000000100000000000000024000000000000001000110000002041000000000000803F000400001000110060237449000000000000803F010400000100000083CFCD0061A7000000000000000024400A0000000000000001000000000000000000F03F000000006C842E410000000000000000000000006C842E410000000000000000D7123F928FA0F63F40420F0000000000
GO
DBCC FREEPROCCACHE
GO

DECLARE @key int = 0
EXEC sp_executesql N'SELECT * FROM T_Emp WHERE Flag = @p1', N'@p1 int', @key
WAITFOR DELAY '00:00:01'
GO 10

-- 10 件の統計情報の状態でクエリを実行
UPDATE STATISTICS T_Emp(IX_Flag) WITH STATS_STREAM = 0x010000000200000000000000000000002B1CE23900000000E00100000000000088010000000000003003000030000000010003000000000000000000DE0100003803FFFF3800000004000A000000000000000000020000000700000083CFCD0061A700000A000000000000000A00000000000000000000000000803FCDCCCC3D00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000100000002000000110000000000A04000002041000000000000803F0000804000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000001C00000000000000240000000000000008000000000000001000110000002041000000000000803F000400000A00000000000000
GO
DBCC FREEPROCCACHE
GO

DECLARE @key int = 0
EXEC sp_executesql N'SELECT * FROM T_Emp WHERE Flag = @p1', N'@p1 int', @key
WAITFOR DELAY '00:00:01'
GO 5
